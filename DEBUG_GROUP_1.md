# デバッググループ1: 認証・アンケート基本機能

## 担当者向けガイド

### 担当範囲
1. **認証システム** - ユーザー登録、ログイン、セッション管理
2. **アンケート管理（CRUD）** - 作成、読取、更新、削除
3. **データベース接続** - Supabase関連の動作確認

### 優先順位でのテスト順序

#### Phase 1: 認証基本機能（最優先）
1. **ログインページ** (`/login`)
   - [ ] ページが正しく表示される
   - [ ] メールアドレスの形式チェック
   - [ ] パスワードの形式チェック
   - [ ] 正しい認証情報でログイン成功
   - [ ] 間違った認証情報でエラー表示
   - [ ] ログイン後、ダッシュボードへリダイレクト

2. **ユーザー登録** (`/register`)
   - [ ] 登録フォームの表示
   - [ ] メールアドレスの重複チェック
   - [ ] パスワード強度の確認
   - [ ] 登録成功後の自動ログイン
   - [ ] プロファイルの作成確認

3. **ログアウト機能**
   - [ ] ヘッダーのログアウトボタン
   - [ ] ログアウト後のリダイレクト
   - [ ] セッションのクリア確認

#### Phase 2: アンケート作成・一覧（高優先）
1. **アンケート作成** (`/surveys/new`)
   - [ ] フォームの表示
   - [ ] タイトル入力（必須）
   - [ ] 説明文入力（任意）
   - [ ] 保存ボタンの動作
   - [ ] 作成後のリダイレクト
   - [ ] データベースへの保存確認

2. **アンケート一覧** (`/surveys`)
   - [ ] 自分のアンケートのみ表示
   - [ ] アンケート数の表示
   - [ ] ステータス別の集計
   - [ ] 検索機能
   - [ ] フィルタリング機能

#### Phase 3: アンケート編集・削除（中優先）
1. **アンケート編集** (`/surveys/[id]/edit`)
   - [ ] 編集ページへのアクセス
   - [ ] 既存データの読み込み
   - [ ] タイトル・説明の更新
   - [ ] 保存機能
   - [ ] 自動保存機能（修正済み）

2. **アンケート削除**
   - [ ] 削除ボタンの表示
   - [ ] 確認ダイアログ
   - [ ] 削除実行
   - [ ] 一覧からの削除確認

### デバッグ用コマンド

```bash
# 開発サーバー起動
npm run dev

# Supabaseログ確認
npx supabase db dump --local

# データベース直接確認（ブラウザコンソール）
const { data } = await supabase.from('surveys').select('*')
console.table(data)
```

### テストシナリオ

#### シナリオ1: 新規ユーザーフロー
1. トップページにアクセス
2. 「新規登録」をクリック
3. test-new@example.com / Test1234! で登録
4. 自動ログインされることを確認
5. アンケート作成ページへ移動
6. 「テストアンケート1」を作成
7. 一覧ページで確認

#### シナリオ2: 既存ユーザーフロー
1. ログインページへアクセス
2. test@example.com / Test1234! でログイン
3. 既存のアンケートが表示されることを確認
4. アンケートを編集
5. 変更が保存されることを確認

### よくある問題と対処法

#### 問題1: ログインできない
- **確認事項**:
  - Supabaseの接続状況
  - .env.localの設定
  - ネットワーク接続
- **デバッグ方法**:
  ```javascript
  // ブラウザコンソールで実行
  const { data, error } = await supabase.auth.signInWithPassword({
    email: 'test@example.com',
    password: 'Test1234!'
  })
  console.log({ data, error })
  ```

#### 問題2: アンケートが表示されない
- **確認事項**:
  - ユーザーIDの一致
  - RLSポリシー
  - データベース接続
- **デバッグページ**: `/debug/surveys`

### 修正記録テンプレート

```markdown
### [日時] 認証/アンケート機能 - [問題の概要]
- **テスト項目**: 
- **問題内容**: 
- **原因**: 
- **修正内容**: 
- **修正ファイル**: 
- **確認結果**: 
```

### 完了基準
- [ ] すべての認証機能が正常動作
- [ ] アンケートCRUD操作が完全動作
- [ ] エラーハンドリングが適切
- [ ] UIがCosmicテーマに準拠
- [ ] パフォーマンスが良好

---

*デバッグ結果は`DEVELOPMENT_LOG.md`に記録してください。*